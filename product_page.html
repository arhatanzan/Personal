<!-- PRODUCT LISTING PAGE – SUPPORTS DOWNLOAD + AMAZON/EXTERNAL + FREE/PAID LABELS -->

<style>
  :root{
    --page-bg: #f8f6f2;
    --card-bg: #ffffff;
    --accent: #d4a017;
    --navy: #0a2342;
    --muted: #5a6673;
    --radius: 10px;
    --gap: 18px;
    --container: 1200px;
  }

  * { box-sizing: border-box; }
  body, html { margin:0; padding:0; font-family: Calibri, Arial, sans-serif; background: var(--page-bg); color: var(--navy); }

  .prod-wrap { max-width: var(--container); margin: 28px auto; padding: 20px; }

  .prod-header { display:flex; gap:16px; align-items:center; justify-content:space-between; margin-bottom: 16px; }
  .prod-title h1 { margin:0; font-size:28px; color:var(--navy); }
  .prod-sub { color:var(--muted); font-size:14px; margin:0; }

  .prod-controls { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
  .search { display:flex; align-items:center; gap:8px; background:#fff; border-radius:8px; padding:8px 10px; }
  .search input { border:0; outline:0; width:220px; font-size:14px; color:var(--navy); background:transparent; }
  .select, .btn { background:#fff; border-radius:8px; padding:8px 12px; font-size:14px; border:1px solid rgba(0,0,0,0.06); }
  .btn { cursor:pointer; }
  .btn.primary { background:var(--accent); color:var(--navy); font-weight:600; }

  .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap:var(--gap); margin-top:18px; }

  .card {
    background: var(--card-bg);
    border-radius: var(--radius);
    padding: 16px;
    border: 6px solid var(--accent);
    display:flex; flex-direction:column; gap:12px;
    min-height:240px;
  }

  .thumb {
    height:110px; border-radius:6px; background: linear-gradient(180deg,#ececec,#fff); display:flex; align-items:center; justify-content:center;
    font-weight:700; color:var(--muted);
  }

  .title { font-size:16px; font-weight:700; margin:0; color:var(--navy); }
  .desc { font-size:14px; color:var(--muted); margin:0; line-height:1.4; }

  .tags { display:flex; gap:8px; flex-wrap:wrap; margin-top:4px; }
  .tag { border:1px solid rgba(0,0,0,0.1); padding:3px 8px; border-radius:999px; font-size:12px; }

  .label-free { background:#0a2342; color:#f8f6f2; border-radius:999px; padding:3px 8px; font-size:12px; }
  .label-paid { background:#7a2e2e; color:#f8f6f2; border-radius:999px; padding:3px 8px; font-size:12px; }

  .card-footer { margin-top:auto; display:flex; justify-content:space-between; align-items:center; gap:8px; }

  .download-btn {
    background:var(--accent); color:var(--navy); border-radius:8px; padding:8px 12px;
    text-decoration:none; font-weight:700; font-size:14px;
  }

  .details-btn {
    background:transparent; border:1px solid rgba(0,0,0,0.1);
    border-radius:8px; padding:6px 10px; font-size:14px; cursor:pointer; color:var(--navy);
  }

  .empty { text-align:center; color:var(--muted); padding:40px 0; }

  /* Modal */
  .modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,0.45); display:none; align-items:center; justify-content:center; z-index:9999; padding:18px; }
  .modal { width:100%; max-width:760px; background:#fff; border-radius:10px; padding:18px; border:6px solid var(--accent); }
  .modal h2 { margin:0 0 8px 0; color:var(--navy); }
  .modal p { margin:0 0 12px 0; color:var(--muted); }
  .modal-actions { display:flex; justify-content:flex-end; gap:8px; margin-top:12px; }

  @media (max-width:800px){
    .search input { width:130px; }
    .prod-title h1 { font-size:22px; }
  }
</style>


<div class="prod-wrap" aria-live="polite">

  <div class="prod-header">
    <div class="prod-title">
      <h1>Digital & Physical Products</h1>
      <div class="prod-sub">Instant downloads + external store products</div>
    </div>

    <div class="prod-controls">
      <div class="search">
        <input id="searchInput" placeholder="Search products…">
      </div>

      <select id="categorySelect" class="select">
        <option value="">All categories</option>
      </select>

      <select id="sortSelect" class="select">
        <option value="new">Newest</option>
        <option value="az">A → Z</option>
        <option value="za">Z → A</option>
      </select>

      <button id="resetBtn" class="btn">Reset</button>
    </div>
  </div>

  <div id="grid" class="grid"></div>
  <div id="empty" class="empty" style="display:none">No products found.</div>
</div>


<!-- MODAL -->
<div id="modalBackdrop" class="modal-backdrop">
  <div class="modal">
    <h2 id="modalTitle"></h2>
    <p id="modalDesc"></p>
    <div id="modalMeta" style="font-weight:700;color:var(--navy);"></div>
    <div class="modal-actions">
      <a id="modalDownload" class="download-btn" href="#">Download</a>
      <button id="modalClose" class="details-btn">Close</button>
    </div>
  </div>
</div>


<script>
/* ============================
   PRODUCT DATA – EDIT HERE
============================ */
const PRODUCTS = [
  {
    id: "p1",
    title: "Data Storytelling Workbook",
    description: "A practical workbook for crafting narratives using data.",
    category: "Guides",
    type: "download",
    price: "free",
    fileUrl: "",
    fileName: "data-storytelling-workbook.pdf",
    thumbText: "Workbook"
  },
  {
    id: "p2",
    title: "Datadog Monitors Cheat Sheet",
    description: "Quick access reference for creating effective monitors.",
    category: "Cheatsheets",
    type: "download",
    price: "free",
    fileUrl: "",
    fileName: "datadog-monitors-cheatsheet.pdf",
    thumbText: "Cheatsheet"
  },
  {
    id: "p3",
    title: "Modern Leadership (Hardcover)",
    description: "A hardcover book available on Amazon.",
    category: "Books",
    type: "external",
    price: "paid",
    externalUrl: "https://amazon.in/your-product",
    buttonLabel: "Buy on Amazon",
    thumbText: "Hardcover"
  },
  {
    id: "p4",
    title: "Digital Democracy Course (Slides)",
    description: "Download slide deck on digital democracy & media.",
    category: "Slides",
    type: "download",
    price: "free",
    fileUrl: "",
    fileName: "digital-democracy-slides.zip",
    thumbText: "Slides"
  },
  {
    id: "p5",
    title: "Aesthetic Portfolio Template",
    description: "A premium digital template on Gumroad.",
    category: "Templates",
    type: "external",
    price: "paid",
    externalUrl: "https://gumroad.com/your-product",
    buttonLabel: "Get Template",
    thumbText: "Template"
  }
];


/* ============================
    RENDERING + FILTER LOGIC
============================ */
const grid = document.getElementById('grid');
const empty = document.getElementById('empty');

const categorySelect = document.getElementById('categorySelect');
const searchInput = document.getElementById('searchInput');
const sortSelect = document.getElementById('sortSelect');
const resetBtn = document.getElementById('resetBtn');

function escapeHtml(s){ return (s||"").replace(/&/g,"&amp;").replace(/</g,"&lt;"); }

/* Populate categories */
(function setupCategories(){
  const cats = [...new Set(PRODUCTS.map(p => p.category))].sort();
  cats.forEach(c => {
    const op = document.createElement('option');
    op.value = c;
    op.textContent = c;
    categorySelect.appendChild(op);
  });
})();

function getFileType(prod){
  if(prod.type === "external") {
    return "LINK";
  }
  if(prod.fileName){
    return prod.fileName.split('.').pop().toUpperCase();
  }
  return "FILE";
}

/* Generate Demo File if fileUrl is blank */
function createDemoFileBlob(p){
  const txt = `${p.title}\n---\n${p.description}\nGenerated: ${new Date().toLocaleString()}`;
  return new Blob([txt], {type:"text/plain"});
}

/* Render a single primary button based on product type */
function renderPrimaryButton(prod){
  if(prod.type === "download"){
    return `<a class="download-btn" data-id="${prod.id}" href="#">Download</a>`;
  }
  if(prod.type === "external"){
    const label = prod.buttonLabel || "Buy Now";
    return `<a class="download-btn" href="${prod.externalUrl}" target="_blank" rel="noopener">${label}</a>`;
  }
  return "";
}

/* FREE/PAID labels */
function renderPriceLabel(prod){
  if(prod.price === "free"){
    return `<span class="label-free">FREE</span>`;
  }
  if(prod.price === "paid"){
    return `<span class="label-paid">PAID</span>`;
  }
  return "";
}

/* Render Cards */
function renderProducts(list){
  grid.innerHTML = "";
  if(!list.length){ empty.style.display="block"; return; }
  empty.style.display="none";

  list.forEach(p => {
    const card = document.createElement('div');
    card.className = "card";
    card.innerHTML = `
      <div class="thumb">${escapeHtml(p.thumbText)}</div>

      <h3 class="title">${escapeHtml(p.title)}</h3>

      <div class="tags">
        <span class="tag">${escapeHtml(p.category)}</span>
        <span class="tag">${escapeHtml(getFileType(p))}</span>
        ${renderPriceLabel(p)}
      </div>

      <p class="desc">${escapeHtml(p.description)}</p>

      <div class="card-footer">
        ${renderPrimaryButton(p)}
        <button class="details-btn" data-id="${p.id}">Details</button>
      </div>
    `;
    grid.appendChild(card);
  });
}


/* SEARCH / FILTER / SORT */
function applyFilters(){
  const q = searchInput.value.toLowerCase().trim();
  const cat = categorySelect.value;
  let list = PRODUCTS.filter(p => {
    const m1 = !cat || p.category === cat;
    const m2 = !q || (p.title + p.description + p.category).toLowerCase().includes(q);
    return m1 && m2;
  });

  if(sortSelect.value === "az") list.sort((a,b)=>a.title.localeCompare(b.title));
  else if(sortSelect.value === "za") list.sort((a,b)=>b.title.localeCompare(a.title));

  renderProducts(list);
}

searchInput.addEventListener("input", applyFilters);
categorySelect.addEventListener("change", applyFilters);
sortSelect.addEventListener("change", applyFilters);

resetBtn.addEventListener("click", ()=>{
  searchInput.value=""; categorySelect.value=""; sortSelect.value="new"; applyFilters();
});


/* ============================
         MODAL LOGIC
============================ */
const modalBackdrop = document.getElementById('modalBackdrop');
const modalTitle = document.getElementById('modalTitle');
const modalDesc = document.getElementById('modalDesc');
const modalMeta = document.getElementById('modalMeta');
const modalDownload = document.getElementById('modalDownload');
const modalClose = document.getElementById('modalClose');

function closeModal(){
  modalBackdrop.style.display="none";
}

/* Opening MODAL */
function openDetails(id){
  const p = PRODUCTS.find(x=>x.id === id);
  if(!p) return;

  modalTitle.textContent = p.title;
  modalDesc.textContent = p.description;
  modalMeta.textContent = `${p.category} • ${p.price.toUpperCase()}`;

  if(p.type === "download"){
    modalDownload.textContent = "Download";
    modalDownload.onclick = () => startDownloadById(id);
  }
  else if(p.type === "external"){
    modalDownload.textContent = p.buttonLabel || "Buy Now";
    modalDownload.onclick = () => window.open(p.externalUrl, "_blank");
  }

  modalBackdrop.style.display="flex";
}

modalClose.addEventListener("click", closeModal);
modalBackdrop.addEventListener("click", (e)=>{ if(e.target === modalBackdrop) closeModal(); });


/* ============================
      DOWNLOAD LOGIC
============================ */
function startDownloadById(id){
  const p = PRODUCTS.find(x=>x.id === id);
  if(!p) return;

  if(p.fileUrl){
    const a = document.createElement("a");
    a.href = p.fileUrl;
    a.download = p.fileName || "";
    a.click();
    return;
  }

  const blob = createDemoFileBlob(p);
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = p.fileName || (p.title + ".txt");
  a.click();
  setTimeout(()=>URL.revokeObjectURL(url), 4000);
}


/* ATTACH CLICK EVENTS */
grid.addEventListener("click", (e)=>{
  const dl = e.target.closest(".download-btn");
  const det = e.target.closest(".details-btn");

  if(dl && dl.dataset.id){
    e.preventDefault();
    startDownloadById(dl.dataset.id);
  }
  if(det){
    openDetails(det.dataset.id);
  }
});


/* INITIAL LOAD */
applyFilters();
</script>
