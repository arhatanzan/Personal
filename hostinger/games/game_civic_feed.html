<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Civic Feed: India Edition</title>
    <style>
      :root {
        --bg-color: #f8f6f2;
        --card-bg: #ffffff;
        --text-main: #102a43;
        --text-light: #627d98;
        --accent-primary: #334e68;
        --color-boost: #27ab83;
        --color-bury: #d64545;
        --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        --font-main: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
      }

      body {
        margin: 0;
        padding: 0;
        font-family: var(--font-main);
        background-color: var(--bg-color);
        color: var(--text-main);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start; /* keep content from vertically centering */
        /* Avoid forcing the body to exactly match viewport height —
           this created large blank space at the end in some viewports/embeds. */
        min-height: auto;
        height: auto;
      }

      header {
        width: 100%;
        max-width: 600px;
        padding: 1rem;
        text-align: center;
        background: var(--card-bg);
        border-bottom: 1px solid #d9e2ec;
      }

      h1 {
        margin: 0;
        font-size: 1.5rem;
        color: var(--accent-primary);
      }
      .subtitle {
        font-size: 0.9rem;
        color: var(--text-light);
        margin-top: 0.5rem;
      }

      /* Dashboard Stats */
      .dashboard {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 10px;
        width: 90%;
        max-width: 600px;
        margin: 1rem 0;
      }

      .stat-box {
        background: var(--card-bg);
        padding: 0.8rem;
        border-radius: 8px;
        text-align: center;
        box-shadow: var(--shadow);
        border: 2px solid transparent;
        transition: all 0.3s ease;
      }

      .stat-label {
        display: block;
        font-size: 0.7rem;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 4px;
        opacity: 0.8;
      }
      .stat-value {
        font-size: 1.4rem;
        font-weight: 800;
        display: block;
      }

      /* Dynamic Stat States */
      .state-critical {
        background-color: #ffe3e3;
        border-color: #d64545;
        color: #610404;
      }
      .state-warning {
        background-color: #fff4ce;
        border-color: #f59f00;
        color: #5c3c00;
      }
      .state-good {
        background-color: #e3fff5;
        border-color: #27ab83;
        color: #00442a;
      }
      .state-neutral {
        background-color: white;
        border-color: #d9e2ec;
        color: var(--text-main);
      }

      /* Game Area */
      /* Game area: align content at top by default so zoom/viewport changes don't create large gaps */
      .game-container {
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        width: 100%;
        max-width: 500px;
        padding-bottom: 0; /* reduce extra bottom spacing */
        position: relative;
      }

      /* Card stack sizes to its content instead of using a fixed height */
      .card-stack {
        position: relative;
        width: 90%;
        height: auto;
        margin-bottom: 20px;
        display: flex;
        justify-content: center;
      }

      /* Make card part of normal flow so it naturally follows the stats/header */
      .card {
        position: relative;
        width: 100%;
        height: auto;
        background: var(--card-bg);
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        padding: 2rem;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        transition: transform 0.3s ease, opacity 0.3s ease;
        border: 1px solid #e1e7ef;
      }

      /* On very tall screens keep the centered presentation */
      @media (min-height: 820px) {
        .game-container { justify-content: center; }
      }

      .card-tag {
        background: #bcccdc;
        color: #102a43;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: bold;
        margin-bottom: 1rem;
        text-transform: uppercase;
      }

      .card-content {
        font-size: 1.15rem;
        line-height: 1.5;
        font-weight: 500;
      }
      .card-source {
        margin-top: 1.5rem;
        font-size: 0.9rem;
        color: var(--text-light);
        font-style: italic;
      }

      /* Controls */
      .controls {
        display: flex;
        gap: 20px;
        width: 90%;
        justify-content: center;
      }

      .btn {
        flex: 1;
        padding: 1rem;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.1s;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .btn:active {
        transform: scale(0.96);
      }
      .btn-bury {
        background-color: #ffe3e3;
        color: var(--color-bury);
        border: 2px solid var(--color-bury);
      }
      .btn-boost {
        background-color: #e3fff5;
        color: var(--color-boost);
        border: 2px solid var(--color-boost);
      }
      .btn span {
        font-size: 0.75rem;
        font-weight: normal;
        margin-top: 4px;
        opacity: 0.8;
      }

      /* End Screen */
      .modal {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.98);
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10;
        padding: 2rem;
        text-align: center;
        box-sizing: border-box;
      }
      .modal.active {
        display: flex;
      }
      .btn-restart {
        background: var(--accent-primary);
        color: white;
        padding: 1rem 2rem;
        border-radius: 8px;
        border: none;
        font-size: 1rem;
        cursor: pointer;
        margin-top: 1rem;
      }

      /* Debug/Accessibility */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
      }

      .copyright {
        margin-top: 15px;
        font-size: 0.75rem;
        color: var(--text-light);
        opacity: 0.6;
        text-align: center;
        width: 100%;
      }
      /* Small-screen responsive fixes: reduce vertical gaps and stack stat boxes */
      @media (max-width: 600px) {
        .dashboard {
          grid-template-columns: 1fr;
          gap: 8px;
          width: 95%;
          margin: 0.5rem 0;
        }
        .stats-bar { grid-template-columns: 1fr; }
        /* Avoid large vertical centering on tall small-viewports */
        .game-container, .game-layout {
          max-width: 100%;
          padding-bottom: 1rem;
          justify-content: flex-start !important;
          padding-top: 0.25rem;
          flex: 0 0 auto; /* don't stretch to fill viewport */
          min-height: 0;
        }
        /* Let the card-stack size to its content on small screens */
        .card-stack { height: auto !important; margin-bottom: 8px; }
        /* Make the card part of normal flow on small screens so it appears immediately below stats */
        .card { position: relative !important; height: auto !important; top: auto !important; left: auto !important; padding: 1.25rem; }
        /* Prevent body from forcing full-viewport layout on mobile browsers */
        body { min-height: auto !important; height: auto !important; }
        .controls, .broadcast-slots { gap: 8px; padding: 8px; justify-content: center; }
        .btn { padding: 0.6rem; font-size: 0.95rem; }
        header { padding: 0.6rem; }
        .copyright { margin-top: 8px; font-size: 0.7rem; }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>The Civic Feed</h1>
      <div class="subtitle">
        India Edition | Target: Maximize Info, Minimize Hate
      </div>
    </header>

    <div class="dashboard">
      <div class="stat-box" id="box-eng">
        <span class="stat-label">Engagement</span>
        <span class="stat-value" id="stat-engagement">50%</span>
      </div>
      <div class="stat-box" id="box-pol">
        <span class="stat-label">Polarization</span>
        <span class="stat-value" id="stat-polarization">20%</span>
      </div>
      <div class="stat-box" id="box-inf">
        <span class="stat-label">Civic Knowledge</span>
        <span class="stat-value" id="stat-info">30%</span>
      </div>
    </div>

    <main class="game-container">
      <div class="card-stack">
        <div class="card" id="active-card">
          <div class="card-tag">System Ready</div>
          <div class="card-content">
            Initializing Indian Democracy Algorithm...<br /><br />Swipe RIGHT
            (Boost) to show users.<br />Swipe LEFT (Bury) to hide.
          </div>
          <div class="card-source">Server</div>
        </div>
      </div>

      <div class="controls">
        <button class="btn btn-bury" onclick="handleChoice('bury')">
          BURY (Left)
          <span>Suppress Post</span>
        </button>
        <button class="btn btn-boost" onclick="handleChoice('boost')">
          BOOST (Right)
          <span>Make Viral</span>
        </button>
      </div>
      <div class="copyright">© 2025 Kaif Abbas</div>
      <div class="sr-only" id="live-feedback" aria-live="polite"></div>
    </main>

    <div class="modal" id="game-over-modal">
      <h2 id="end-title">Simulation Ended</h2>
      <p id="end-desc">Results loading...</p>
      <button class="btn-restart" onclick="initGame()">
        Restart Simulation
      </button>
    </div>

    <script>
      // --- 50+ INDIAN CONTEXT CARDS ---
      const DECK = [
        // POLICY & INFRA
        {
          text: "Detailed PDF: How the new Metro line alignment was chosen.",
          source: "Govt Portal",
          type: "Policy",
          effects: { engage: -10, polar: -5, info: +20 },
        },
        {
          text: "RTI Activist reveals breakdown of road repair funds.",
          source: "Citizen Watch",
          type: "Civic",
          effects: { engage: -5, polar: 0, info: +15 },
        },
        {
          text: "RBI announces new repo rate: Impact on your EMI explained.",
          source: "Econ Weekly",
          type: "Education",
          effects: { engage: -10, polar: -5, info: +25 },
        },
        {
          text: "High Court livestreams hearing on river pollution.",
          source: "Legal Update",
          type: "Civic",
          effects: { engage: -5, polar: 0, info: +10 },
        },
        {
          text: "Municipality releases fogging schedule for dengue prevention.",
          source: "City Corp",
          type: "Civic",
          effects: { engage: -5, polar: 0, info: +15 },
        },
        {
          text: "Explainer: The difference between State and Central taxes on fuel.",
          source: "FactCheck India",
          type: "Education",
          effects: { engage: -5, polar: -5, info: +20 },
        },
        {
          text: "Annual Budget: Education sector allocation increases by 2%.",
          source: "DD News",
          type: "Policy",
          effects: { engage: -10, polar: -2, info: +15 },
        },
        {
          text: "New guidelines issued for apartment RWA elections.",
          source: "Legal Blog",
          type: "Civic",
          effects: { engage: -15, polar: 0, info: +10 },
        },
        {
          text: "Documentary on the history of Indian Railways (1 hour long).",
          source: "Public TV",
          type: "Education",
          effects: { engage: -20, polar: -5, info: +20 },
        },
        {
          text: "Traffic Police explains new fines for driving on wrong side.",
          source: "Traffic Dept",
          type: "Policy",
          effects: { engage: +5, polar: +5, info: +15 },
        },
        {
          text: "Farmer explains how MSP calculation actually works.",
          source: "Rural Voice",
          type: "Policy",
          effects: { engage: -5, polar: -5, info: +20 },
        },
        {
          text: "ISRO announces launch date for new solar mission.",
          source: "Science Daily",
          type: "Education",
          effects: { engage: +10, polar: -5, info: +15 },
        },

        // OUTRAGE
        {
          text: "DEBATE NIGHT: Panelist throws water glass at opponent!",
          source: "Noida TV Hub",
          type: "Outrage",
          effects: { engage: +35, polar: +20, info: -10 },
        },
        {
          text: "Video: Politician forgets National Anthem lyrics? SHAMEFUL!",
          source: "Viral Clipz",
          type: "Outrage",
          effects: { engage: +30, polar: +25, info: -5 },
        },
        {
          text: "Celebrity spotted wearing shoes inside temple? OUTRAGE!",
          source: "Culture Warrior",
          type: "Outrage",
          effects: { engage: +25, polar: +15, info: -10 },
        },
        {
          text: "Opposition leader eats non-veg during holy month? PICS!",
          source: "24/7 Breaking",
          type: "Outrage",
          effects: { engage: +30, polar: +25, info: -5 },
        },
        {
          text: "WATCH: Two uncles fighting over parking spot in Delhi.",
          source: "Street Cam",
          type: "Distraction",
          effects: { engage: +25, polar: +5, info: 0 },
        },
        {
          text: "Anchor screams 'THE NATION WANTS TO KNOW' for 10 mins.",
          source: "Prime Time",
          type: "Outrage",
          effects: { engage: +40, polar: +20, info: -15 },
        },
        {
          text: "College students protest over canteen prices. 'ANTI-NATIONAL'?",
          source: "Angry Bird",
          type: "Outrage",
          effects: { engage: +25, polar: +30, info: -10 },
        },
        {
          text: "Actor says something dumb about history. Boycott trends.",
          source: "Twitter Trends",
          type: "Outrage",
          effects: { engage: +35, polar: +15, info: -10 },
        },

        // MISINFO & WHATSAPP
        {
          text: "FWD: UNESCO declares Indian National Anthem 'Best in Universe'.",
          source: "Family Group",
          type: "Misinfo",
          effects: { engage: +15, polar: +5, info: -10 },
        },
        {
          text: "Home Remedy: Put onions in socks to cure all viruses instantly!",
          source: "Grandma's Fwd",
          type: "Misinfo",
          effects: { engage: +20, polar: 0, info: -20 },
        },
        {
          text: "Secret GPS chip found in 2000 rupee notes? Watch Proof!",
          source: "Tech Truths?",
          type: "Misinfo",
          effects: { engage: +35, polar: +10, info: -25 },
        },
        {
          text: "NASA satellite image shows India lights up on Diwali only.",
          source: "WhatsApp Uni",
          type: "Misinfo",
          effects: { engage: +25, polar: 0, info: -5 },
        },
        {
          text: "Ancient aliens built the Kailasa temple? Scientists baffled!",
          source: "Mystery Tube",
          type: "Misinfo",
          effects: { engage: +20, polar: 0, info: -15 },
        },
        {
          text: "Nehru actually born in London? Secret birth certificate leak!",
          source: "History Redux",
          type: "Misinfo",
          effects: { engage: +30, polar: +25, info: -30 },
        },
        {
          text: "Eating only raw garlic cures blood pressure in 2 hours.",
          source: "Health Guru",
          type: "Misinfo",
          effects: { engage: +15, polar: 0, info: -15 },
        },
        {
          text: "World Bank CEO is actually an Indian guy named Raju? FWD!",
          source: "Pride Group",
          type: "Misinfo",
          effects: { engage: +15, polar: 0, info: -5 },
        },
        {
          text: "If you don't forward this to 10 people, bad luck for 7 years.",
          source: "Chain Msg",
          type: "Misinfo",
          effects: { engage: +10, polar: 0, info: -5 },
        },

        // POLARIZATION
        {
          text: "Why 'Those People' are secretly buying all the land in your city.",
          source: "Radical Blog",
          type: "Polarization",
          effects: { engage: +40, polar: +35, info: -20 },
        },
        {
          text: "Film Review: This movie attacks our culture and must be banned.",
          source: "Sanskari Reviews",
          type: "Polarization",
          effects: { engage: +30, polar: +25, info: -10 },
        },
        {
          text: "Opinion: Why state language imposition is destroying unity.",
          source: "Regional Voice",
          type: "Polarization",
          effects: { engage: +25, polar: +20, info: +5 },
        },
        {
          text: "Are 'Outsiders' stealing local jobs? Special Report.",
          source: "Local News",
          type: "Polarization",
          effects: { engage: +35, polar: +25, info: -10 },
        },
        {
          text: "True History: Why your ancestors were actually the kings of everything.",
          source: "Past Glory",
          type: "Polarization",
          effects: { engage: +25, polar: +15, info: -15 },
        },

        // DISTRACTION
        {
          text: "Cricketer buys a luxury SUV. See exclusive photos!",
          source: "Page 3 Daily",
          type: "Distraction",
          effects: { engage: +15, polar: -5, info: -5 },
        },
        {
          text: "Wedding Season: Who wore the most expensive Lehenga?",
          source: "BollyBuzz",
          type: "Distraction",
          effects: { engage: +20, polar: 0, info: -5 },
        },
        {
          text: "10 Reasons why Biryani is better than Pulao.",
          source: "Foodie Blog",
          type: "Distraction",
          effects: { engage: +15, polar: +5, info: 0 },
        },
        {
          text: "Viral Video: Dog riding a scooter in Bengaluru traffic.",
          source: "Cute Daily",
          type: "Distraction",
          effects: { engage: +25, polar: -10, info: 0 },
        },
        {
          text: "Which Star Kid is launching next? Click to see.",
          source: "Nepo News",
          type: "Distraction",
          effects: { engage: +15, polar: +5, info: -5 },
        },
        {
          text: "Memes about the heatwave that are too relatable.",
          source: "Meme page",
          type: "Distraction",
          effects: { engage: +20, polar: 0, info: 0 },
        },
        {
          text: "IPL Auction: Who became a millionaire overnight?",
          source: "CricInfo",
          type: "Distraction",
          effects: { engage: +25, polar: 0, info: 0 },
        },

        // CIVIC ISSUES
        {
          text: "Bangalore Techie stuck in traffic for 4 hours, builds app.",
          source: "Startup News",
          type: "Civic",
          effects: { engage: +15, polar: 0, info: +5 },
        },
        {
          text: "Monsoon Chaos: Mumbai local trains delayed by 20 mins.",
          source: "Commuter Alert",
          type: "Civic",
          effects: { engage: +10, polar: 0, info: +10 },
        },
        {
          text: "Power cuts expected in Sector 4 due to maintenance.",
          source: "Power Discom",
          type: "Civic",
          effects: { engage: +5, polar: +5, info: +15 },
        },
        {
          text: "Water tanker mafia exposed in sting operation.",
          source: "Investigate",
          type: "Civic",
          effects: { engage: +20, polar: +5, info: +15 },
        },
        {
          text: "Stray cattle menace on highway: Authority responds.",
          source: "Highway Patrol",
          type: "Civic",
          effects: { engage: +10, polar: +5, info: +10 },
        },
      ];

      // --- STATE ---
      let state = {
        engagement: 50,
        polarization: 20,
        info: 30,
        turn: 0,
        maxTurns: 20,
        weights: {},
        cardCounts: new Map(), // Tracks how many times a card has been shown
      };

      let currentCard = null;

      function initGame() {
        state = {
          engagement: 50,
          polarization: 20,
          info: 30,
          turn: 0,
          maxTurns: 20,
          weights: {
            Policy: 1,
            Civic: 1,
            Outrage: 1,
            Misinfo: 1,
            Polarization: 1,
            Distraction: 1,
            Education: 1,
          },
          cardCounts: new Map(),
        };
        document.getElementById("game-over-modal").classList.remove("active");
        updateStatsUI();
        loadNextCard();
      }

      // --- LOGIC ---
      function getWeightedRandomCard() {
        let typePool = [];
        for (let [type, weight] of Object.entries(state.weights)) {
          let count = Math.min(Math.floor(weight * 2), 20);
          for (let i = 0; i < count; i++) typePool.push(type);
        }

        let selectedType =
          typePool[Math.floor(Math.random() * typePool.length)];

        // Filter cards by TYPE and USAGE LIMIT (< 2)
        let candidates = DECK.filter(
          (c) => c.type === selectedType && (state.cardCounts.get(c) || 0) < 2
        );

        // Fallback: If all cards of this type are used up, pick ANY card with usage < 2
        if (candidates.length === 0) {
          candidates = DECK.filter((c) => (state.cardCounts.get(c) || 0) < 2);
        }

        // Emergency fallback: If everything is used up (unlikely), pick random
        if (candidates.length === 0)
          return DECK[Math.floor(Math.random() * DECK.length)];

        let chosen = candidates[Math.floor(Math.random() * candidates.length)];

        // Update count
        state.cardCounts.set(chosen, (state.cardCounts.get(chosen) || 0) + 1);

        return chosen;
      }

      function loadNextCard() {
        if (state.turn >= state.maxTurns) {
          endGame();
          return;
        }

        currentCard = getWeightedRandomCard();

        const cardEl = document.getElementById("active-card");
        cardEl.style.transform = "translate(0, 0) rotate(0deg)";
        cardEl.style.opacity = "1";

        cardEl.querySelector(".card-tag").innerText = currentCard.type;
        cardEl.querySelector(".card-content").innerText = currentCard.text;
        cardEl.querySelector(".card-source").innerText = currentCard.source;

        // Accessibility
        document.getElementById(
          "live-feedback"
        ).innerText = `New card: ${currentCard.type}. ${currentCard.text}`;
      }

      function handleChoice(action) {
        if (!currentCard) return;

        if (action === "boost") {
          state.engagement += currentCard.effects.engage;
          state.polarization += currentCard.effects.polar;
          state.info += currentCard.effects.info;

          // Viral Logic: Boost creates more of same type
          if (
            ["Misinfo", "Outrage", "Polarization"].includes(currentCard.type)
          ) {
            state.weights[currentCard.type] += 1.5;
            state.weights["Policy"] -= 0.5;
          }

          animateCard(1);
        } else {
          // Bury logic
          state.engagement -= 2;
          if (["Misinfo", "Outrage"].includes(currentCard.type)) {
            if (state.weights[currentCard.type] > 1)
              state.weights[currentCard.type] -= 0.2;
          }

          animateCard(-1);
        }

        // Normalize weights
        for (let key in state.weights) {
          if (state.weights[key] < 0.1) state.weights[key] = 0.1;
        }

        state.engagement = clamp(state.engagement, 0, 100);
        state.polarization = clamp(state.polarization, 0, 100);
        state.info = clamp(state.info, 0, 100);

        state.turn++;
        updateStatsUI();

        setTimeout(() => {
          if (state.engagement <= 0)
            endGame(
              "Platform Dead",
              "Nobody is using your platform anymore. You ran out of funding."
            );
          else if (state.polarization >= 100)
            endGame(
              "Riots in the Streets",
              "Your algorithm stoked so much hate that internet services have been suspended."
            );
          else loadNextCard();
        }, 300);
      }

      function animateCard(direction) {
        const cardEl = document.getElementById("active-card");
        cardEl.style.transform = `translate(${
          direction * 250
        }px, 40px) rotate(${direction * 25}deg)`;
        cardEl.style.opacity = "0";
      }

      function updateStatsUI() {
        const engEl = document.getElementById("stat-engagement");
        const polEl = document.getElementById("stat-polarization");
        const infEl = document.getElementById("stat-info");

        const boxEng = document.getElementById("box-eng");
        const boxPol = document.getElementById("box-pol");
        const boxInf = document.getElementById("box-inf");

        engEl.innerText = Math.round(state.engagement) + "%";
        polEl.innerText = Math.round(state.polarization) + "%";
        infEl.innerText = Math.round(state.info) + "%";

        // Color Logic
        setBoxState(boxPol, state.polarization, true);
        setBoxState(boxInf, state.info, false);
        setBoxState(boxEng, state.engagement, false);
      }

      function setBoxState(element, value, reverse) {
        element.classList.remove(
          "state-good",
          "state-warning",
          "state-critical",
          "state-neutral"
        );

        if (reverse) {
          if (value > 75) element.classList.add("state-critical");
          else if (value > 40) element.classList.add("state-warning");
          else element.classList.add("state-good");
        } else {
          if (value < 25) element.classList.add("state-critical");
          else if (value < 50) element.classList.add("state-warning");
          else element.classList.add("state-good");
        }
      }

      function endGame(titleOverride = null, descOverride = null) {
        const modal = document.getElementById("game-over-modal");
        const title = document.getElementById("end-title");
        const desc = document.getElementById("end-desc");
        modal.classList.add("active");

        if (titleOverride) {
          title.innerText = titleOverride;
          desc.innerText = descOverride;
          return;
        }

        if (state.info > 60 && state.polarization < 40) {
          title.innerText = "The Ideal Democracy";
          desc.innerText =
            "You prioritized truth over clicks. Your platform isn't the most profitable, but the country is peaceful and informed.";
        } else if (state.info < 20 && state.engagement > 80) {
          title.innerText = "WhatsApp University Dean";
          desc.innerText =
            "Your users are addicted but completely misinformed. You are rich, but society is dumber.";
        } else if (state.polarization > 70) {
          title.innerText = "Chaos Agent";
          desc.innerText =
            "You amplified hate for engagement. The platform is booming, but neighbors are fighting in the streets.";
        } else {
          title.innerText = "Average Social Media";
          desc.innerText =
            "A mix of cat videos, slight outrage, and occasional news. Nothing changed much.";
        }
      }

      function clamp(val, min, max) {
        return Math.min(Math.max(val, min), max);
      }

      document.addEventListener("keydown", (e) => {
        if (e.key === "ArrowLeft") handleChoice("bury");
        if (e.key === "ArrowRight") handleChoice("boost");
      });

      initGame();

      function sendHeight() {
        const height = document.body.scrollHeight;
        parent.postMessage({ type: "resizeIframe", height: height }, "*");
      }

      window.addEventListener("load", sendHeight);

      if ("ResizeObserver" in window) {
        new ResizeObserver(sendHeight).observe(document.body);
      }
    </script>
  </body>
</html>
